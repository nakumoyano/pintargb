<app-sidebar></app-sidebar>
<app-navbar></app-navbar>
<div id="content">
  <div class="row">
    <div class="col-lg-10 col-md-12 mx-auto">
      <div class="table-wrapper">
        <div class="table-title">
          <div class="row">
            <div
              class="col-sm-6 p-0 d-flex justify-content-lg-start justify-content-center"
            >
              <h2 class="ml-lg-12">Nueva Venta</h2>
            </div>
          </div>
        </div>

        <!-- -------------------------------------------------------------------------------- -->
        <!-- -------------------------------- FORMULARIO ------------------------------------ -->

        <form>
          <h2>Datos de la Venta</h2>
          <hr />
          <div class="col-lg-12 d-flex">
            <div class="form-group col-lg-6 px-0 justify-content-start">
              <label for="inputVendedor">Vendedor:</label>
              <select
                class="form-control"
                name="empleadoId"
                id="inputVendedor"
                [(ngModel)]="venta.empleadoId"
              >
                <option
                  *ngFor="let empleado of employees"
                  [ngValue]="empleado.id"
                >
                  {{ empleado.nombre }}
                </option>
              </select>
            </div>
            <div class="form-group col-lg-6">
              <label for="inputPago">Tipo de pago:</label>
              <select
                class="form-control custom-select"
                name="tipoPagoId"
                id="inputPago"
                [(ngModel)]="venta.tipoPagoId"
                [disabled]="checkImage"
              >
                <option *ngFor="let tipo of tiposPagos" [ngValue]="tipo.id">
                  {{ tipo.tipo }}
                </option>
              </select>
            </div>
          </div>
          <div class="d-flex form-group">
            <div class="form-check">
              <input
                class="form-input mr-2"
                type="checkbox"
                value=""
                id="flexCheckChecked"
                (click)="checkImageFunction()"
              />
              <label class="form-check-label" for="flexCheckChecked">
                Paga con Mercado Pago</label
              >
            </div>
            <div class="form-group col-6">
              <img
                src="https://d2r9epyceweg5n.cloudfront.net/stores/134/586/products/mercadopago-0021-8680b79384133bb29915872305530390-1024-1024.jpg"
                alt="mercado-pago"
                width="150px"
                [ngClass]="!checkImage ? 'd-none' : 'd-block'"
                [(ngModel)]="venta.tipoPagoId"
                name="tipoPagoId"
              />
            </div>
          </div>

          <div class="form-group">
            <div class="form-check">
              <input
                class="form-input mr-2"
                type="checkbox"
                value=""
                id="flexCheckChecked"
                (click)="checkFunction()"
              />
              <label class="form-check-label" for="flexCheckChecked">
                Nuevo cliente</label
              >
            </div>
          </div>
          <div class="col-lg-12 d-flex mt-3">
            <div class="form-group col-lg-6 px-0 justify-content-start">
              <label for="inputCliente">Cliente:</label>
              <select
                class="form-control"
                name="clienteId"
                id="inputCliente"
                [(ngModel)]="venta.clienteId"
                [disabled]="check"
              >
                <option *ngFor="let cliente of clients" [ngValue]="cliente.id">
                  {{ cliente.nombre }}
                </option>
              </select>
            </div>
            <div class="form-group col-lg-6">
              <label for="inputNombre">Crear nuevo cliente:</label>
              <button
                class="btn btn-primary form-control"
                [disabled]="!check"
                routerLink="/nuevo-cliente"
                routerLinkActive="active"
              >
                Ir
              </button>
            </div>
          </div>
          <div class="col-12 d-flex">
            <div class="form-group col-lg-6 px-0">
              <label for="inputProducto">Producto:</label>
              <select
                class="form-control"
                name="productoId"
                id="inputProducto"
                [(ngModel)]="venta.productoId"
              >
                <option
                  *ngFor="let producto of products"
                  [ngValue]="producto.id"
                >
                  {{ producto.nombre }}
                </option>
              </select>
            </div>
          </div>
          <div class="col-lg-12 d-flex mt-3">
            <div class="form-group col-lg-6 px-0 justify-content-start">
              <label for="inputFecha">Fecha:</label>
              <input
                type="date"
                class="form-control"
                id="inputFecha"
                name="fecha"
                [(ngModel)]="venta.fecha"
                required
              />
            </div>
            <div class="form-group col-6">
              <label for="inputImporte">Importe total:</label>
              <div class="d-flex">
                <span class="p-total pt-2">$</span>
                <input
                  type="number"
                  class="form-control"
                  id="inputImporte"
                  name="total"
                  placeholder="Ingrese el importe total de la venta"
                  required
                  [(ngModel)]="venta.total"
                />
              </div>
            </div>
          </div>
        </form>
        <button
          class="btn btn-success mb-3"
          role="button"
          (click)="agregar()"
          *ngIf="!venta.id; else elseBlock"
        >
          Cargar venta
        </button>

        <ng-template #elseBlock>
          <button class="btn btn-success mb-3" (click)="update()">
            Actualizar
          </button>
        </ng-template>
      </div>
    </div>
  </div>
</div>
